(()=>{"use strict";var t,e,n=function(){function t(t,e,n,r){this.x=t,this.y=e,this.width=n,this.height=r}return t.create=function(t){return new this(t.x,t.y,t.width,t.height)},t.prototype.splitTop=function(e){return[new t(this.x,this.y,this.width,e),new t(this.x,this.y+e,this.width,this.height-e)]},t.prototype.splitBottom=function(e){return[new t(this.x,this.y,this.width,this.height-e),new t(this.x,this.y+(this.height-e),this.width,e)]},t.prototype.splitLeft=function(e){return[new t(this.x,this.y,e,this.height),new t(this.x+e,this.y,this.width-e,this.height)]},t.prototype.splitRight=function(e){return[new t(this.x,this.y,this.width-e,this.height),new t(this.x+(this.width-e),this.y,e,this.height)]},t}(),r=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),l=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)l.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return l},i=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},o=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];throw new Error(String.raw.apply(String,i([t],r(e))))},l=function(e){return o(t||(n=["unreachable"],r=["unreachable"],Object.defineProperty?Object.defineProperty(n,"raw",{value:r}):n.raw=r,t=n));var n,r};!function(t){t.fromArrayOrError=function(t,e){if(e.length===t)return e;throw new Error("length: "+t+", array.length: "+e.length+", array: "+JSON.stringify(e))},t.last=function(t){return t[t.length-1]}}(e||(e={}));const a=e;var u,s,c,h,f,p,d,v,y,g,m,w,b,x=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},S=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),l=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)l.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return l},_=function(t){switch(t){case"波型":return"Wave";case"跳ね小型":return"JumpSmall";case"跳ね大型":return"JumpBig";case"減少型":return"Decrease";default:return"?"}},O=function(t,e,n){return e.reduce((function(t,e){var r=n(e);return t<r?r:t}),t)},T=function(t){return t.actualBoundingBoxAscent+t.actualBoundingBoxDescent},k=function(){function t(){}return t.Defaults={fillStyle:"#000",lineWidth:1,strokeStyle:"#000"},t}(),A=function(){function t(){this.visuals=[]}return t.prototype.push=function(t){this.visuals.push(t)},t.prototype.clear=function(){this.visuals.length=0},t.prototype.render=function(t){t.context.save();for(var e=0,n=this.visuals;e<n.length;e++)n[e].render(t);t.context.restore()},t}(),z=(p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),P=function(t){function e(e,n,r,i,o){var l,a,u,s,c=t.call(this)||this,h=e.canvas;c.text=n,c.normalizedX=r/h.width,c.normalizedY=i/h.height,c.font=null!==(l=null==o?void 0:o.font)&&void 0!==l?l:"0.8rem 'YuGothic', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica', sans-serif",c.fillStyle=null!==(a=null==o?void 0:o.fillStyle)&&void 0!==a?a:k.Defaults.fillStyle,c.textAlign=null!==(u=null==o?void 0:o.textAlign)&&void 0!==u?u:"start",c.textBaseline=null!==(s=null==o?void 0:o.textBaseline)&&void 0!==s?s:"alphabetic";var f=e.measureText(n);return c.width=f.width,c.height=T(f),c}return z(e,t),e.prototype.render=function(t){var e=t.context,n=t.canvasWidth,r=t.canvasHeight;e.font=this.font,e.fillStyle=this.fillStyle,e.textAlign=this.textAlign,e.textBaseline=this.textBaseline,e.fillText(this.text,n*this.normalizedX,r*this.normalizedY)},e}(k),W=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),E=function(t){function e(e,n,r,i,o,l){var a,u,s=t.call(this)||this,c=e.canvas,h=c.width,f=c.height;return s.normalizedX1=n/h,s.normalizedY1=r/f,s.normalizedX2=i/h,s.normalizedY2=o/f,s.lineWidth=null!==(a=null==l?void 0:l.lineWidth)&&void 0!==a?a:k.Defaults.lineWidth,s.strokeStyle=null!==(u=null==l?void 0:l.strokeStyle)&&void 0!==u?u:k.Defaults.strokeStyle,s}return W(e,t),e.prototype.render=function(t){var e=t.context,n=t.canvasWidth,r=t.canvasHeight;e.lineWidth=this.lineWidth,e.strokeStyle=this.strokeStyle,e.beginPath(),e.moveTo(this.normalizedX1*n|0,this.normalizedY1*r|0),e.lineTo(this.normalizedX2*n|0,this.normalizedY2*r|0),e.stroke()},e}(k),M=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),j=function(){function t(){this._segments=[]}return t.prototype.moveTo=function(t,e){this._segments.push(0,t,e)},t.prototype.lineTo=function(t,e){this._segments.push(1,t,e)},t.prototype.itemKind=function(t){return this._segments[3*t]},t.prototype.itemX=function(t){return this._segments[3*t+1]},t.prototype.itemY=function(t){return this._segments[3*t+2]},Object.defineProperty(t.prototype,"count",{get:function(){return this._segments.length/3},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){return new Float64Array(this._segments)},t}(),B=function(t){function e(e,n,r){for(var i,o,l,a,u=t.call(this)||this,s=e.canvas,c=s.width,h=s.height,f=u.normalizedPath=n.serialize(),p=0,d=f.length;p<d;p+=3)f[p+1]/=c,f[p+2]/=h;return u.lineWidth=null!==(i=null==r?void 0:r.lineWidth)&&void 0!==i?i:k.Defaults.lineWidth,u.strokeStyle=null!==(o=null==r?void 0:r.strokeStyle)&&void 0!==o?o:k.Defaults.strokeStyle,u.fillStyle=null!==(l=null==r?void 0:r.fillStyle)&&void 0!==l?l:k.Defaults.fillStyle,u.drawingMode=null!==(a=null==r?void 0:r.drawingMode)&&void 0!==a?a:1,u}return M(e,t),e.prototype.render=function(t){var e=t.context,n=t.canvasWidth,r=t.canvasHeight,i=this.normalizedPath,o=this.drawingMode;e.lineWidth=this.lineWidth,e.strokeStyle=this.strokeStyle,e.fillStyle=this.fillStyle,e.beginPath(),e.moveTo(0,0);for(var a=0,u=i.length;a<u;a+=3){var s=i[a],c=i[a+1]*n,h=i[a+2]*r;switch(s){case 0:e.moveTo(c,h);break;case 1:e.lineTo(c,h);break;default:l()}}switch(o){case 0:return e.fill();case 1:return e.stroke();default:l()}},e}(k),C=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},F=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),l=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)l.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return l},L=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},D=function(){function t(){var t;this.visuals=new A,this.previousTimestampMs=performance.now();var e=function(){var t=document.createElement("div"),e=t.style;e.width="100%",e.height="32em",e.marginTop=e.marginBottom="2%";var n=document.createElement("canvas");return n.style.display="block",t.appendChild(n),{pictureFrame:t,canvas:n}}(),n=e.pictureFrame,r=e.canvas;this.pictureFrame=n,this.canvas=r,this.renderingContext=null!==(t=r.getContext("2d"))&&void 0!==t?t:o(d||(d=C(["2d context"],["2d context"])))}return Object.defineProperty(t.prototype,"element",{get:function(){return this.pictureFrame},enumerable:!1,configurable:!0}),t.prototype.createLabel=function(t){return{text:t,font:this.renderingContext.font="0.8rem 'YuGothic', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica', sans-serif",metrics:this.renderingContext.measureText(t)}},t.prototype.updateCanvasSize=function(){var t=this,e=t.canvas,n=t.pictureFrame;t.renderingContext,e.width=n.offsetWidth,e.height=n.offsetHeight},t.prototype.createGraphVisuals=function(t){var e=this,r=this,i=r.canvas,o=r.renderingContext,l=r.visuals;this.updateCanvasSize();var u=n.create({x:0,y:0,width:i.width,height:i.height});i.scrollIntoView();var s,c,h=Array.from("月火水木金土").flatMap((function(t){return[t+"前",t+"後"]})).map((function(t){return{label:e.createLabel(t)}})),f=(s=O(0,t,(function(t){return O(0,t.values,(function(t){var e=F(t,2),n=e[0],r=e[1];return Math.max(n,r)}))})),c=Math.pow(10,Math.floor(Math.log10(Math.abs(s)))),Math.ceil(s/c)*c),p=f/4,d=[0,p,2*p,3*p,f].map((function(t){var n=String(t);return{value:t,label:e.createLabel(n)}})),v=O(0,d,(function(t){return t.label.metrics.width})),y=O(0,h,(function(t){return T(t.label.metrics)})),g=F(u.splitRight(O(0,h,(function(t){return t.label.metrics.width/2}))),2),m=g[0],w=g[1],b=F(m.splitTop(O(0,d,(function(t){return T(t.label.metrics)}))),2),x=(b[0],b[1]),S=F(x.splitBottom(y+.05*u.height),2),_=S[0],k=S[1],A=w.width,z=F(_.splitLeft(v+A),2),W=z[0],M=z[1],C=F(k.splitLeft(W.width),2)[1],D=function(t){return W.y+(W.height-t*(W.height/(d.length-1)))};l.clear();var Y={fillStyle:"gray",textAlign:"right",textBaseline:"middle"};d.forEach((function(t,e){var n=t.label,r=W.width-A,i=D(e);l.push(new P(o,n.text,r,i,Y))}));var G={lineWidth:1};d.forEach((function(t,e){G.strokeStyle=0===e?"rgba(0, 0, 0, 0.5)":"rgba(0, 0, 0, 0.2)";var n=W.width-A,r=D(e);l.push(new E(o,n,r,u.width,r,G))}));var H={textAlign:"center",textBaseline:"bottom",fillStyle:"gray"};h.forEach((function(t,e){var n=t.label,r=C.x+e*(C.width/(h.length-1)),i=u.height;l.push(new P(o,n.text,r,i,H))}));var X=function(t,e,n){void 0===n&&(n=!1);var r=t.values,i=t.probability,l=function(t,e){return[M.x+e*(M.width/(r.length-1)),M.y+M.height-M.height*(t/f)]},u=F(r[0],2)[1],s=F(function(t,e,n){var r=t/60,i=1*(1-Math.abs(r%2-1)),o=0,l=0,a=0;0<=r&&r<1&&(o=1,l=i,a=0),1<=r&&r<2&&(o=i,l=1,a=0),2<=r&&r<3&&(o=0,l=1,a=i),3<=r&&r<4&&(o=0,l=i,a=1),4<=r&&r<5&&(o=i,l=0,a=1),5<=r&&r<6&&(o=1,l=0,a=i);return[o=255*(o+=0)|0,l=255*(l+=0)|0,a=255*(a+=0)|0]}(e),3),c=s[0],h=s[1],p=s[2],d=new j;d.moveTo.apply(d,L([],F(l(u,0)))),r.forEach((function(t,e){var n=F(t,2)[1];d.lineTo.apply(d,L([],F(l(n,e))))}));var v=F(a.last(r),1)[0],y=l(v,r.length-1);return n?d.lineTo.apply(d,L([],F(y))):d.moveTo.apply(d,L([],F(y))),r.concat().reverse().forEach((function(t,e,n){var r=F(t,1)[0];d.lineTo.apply(d,L([],F(l(r,n.length-e-1))))})),new B(o,d,{lineWidth:1,strokeStyle:"rgba("+c+", "+h+", "+p+", 0.2)",fillStyle:"rgba("+c+", "+h+", "+p+", "+.5*i+")",drawingMode:n?0:1})};t.forEach((function(e,n){var r=n/t.length*360;l.push(X(e,r)),l.push(X(e,r,!0))})),console.log(JSON.stringify({yLabelArea:W}))},t.prototype.drawGraph=function(t){this.previousTimestampMs,this.previousTimestampMs=t;var e=this,n=e.canvas,r=e.renderingContext,i=e.visuals;r.clearRect(0,0,n.width,n.height);var o={context:r,canvasWidth:n.width,canvasHeight:n.height};i.render(o)},t}();w=new D,b=w.element,m=function(){return t=void 0,e=void 0,r=function(){var t,e,n,r,i;return function(t,e){var n,r,i,o,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,r=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!((i=(i=l.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){l=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){l.label=o[1];break}if(6===o[0]&&l.label<i[1]){l.label=i[1],i=o;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(o);break}i[2]&&l.ops.pop(),l.trys.pop();continue}o=e.call(t,l)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(l){return t=null!==(n=document.querySelector("#filter"))&&void 0!==n?n:o(v||(v=C(["#filter"],["#filter"]))),(null!==(r=t.parentElement)&&void 0!==r?r:o(y||(y=C(["parent"],["parent"])))).insertBefore(b,t.nextSibling),e=null!==(i=document.querySelector("#output"))&&void 0!==i?i:o(g||(g=C(["#output"],["#output"]))),new ResizeObserver((function(){console.log("グラフ再描画 ( 額縁のサイズ変更 )"),w.updateCanvasSize(),w.drawGraph(performance.now())})).observe(b),new MutationObserver((function(){var t;console.log("グラフ再描画 ( 元データの変更 )"),w.createGraphVisuals((t=e,Array.from(t.querySelectorAll(":scope > tr")).filter((function(t){return 0===t.classList.length})).map((function(t){var e,n,r=S(Array.from(t.querySelectorAll("td"))),i=r[0],l=void 0===i?o(u||(u=x(["variant"],["variant"]))):i,p=r[1],d=void 0===p?o(s||(s=x(["probability"],["probability"]))):p,v=r.slice(3),y=v.slice(0,v.length-2);return{variant:_(l.innerText.trim()),probability:.01*Number(null!==(n=null===(e=/^\s*(.+)%\s*$/.exec(d.innerText))||void 0===e?void 0:e[1])&&void 0!==n?n:o(c||(c=x(["probability"],["probability"])))),values:a.fromArrayOrError(12,y.map((function(t){var e,n=S(null!==(e=/^\s*(\d+)(~(\d+))?\s*$/.exec(t.innerText))&&void 0!==e?e:o(h||(h=x(["values"],["values"]))),4),r=n[1],i=void 0===r?o(f||(f=x(["values.min"],["values.min"]))):r,l=n[3],a=void 0===l?i:l;return[Number(i),Number(a)]})))}}))))})).observe(e,{childList:!0,subtree:!0}),requestAnimationFrame((function t(e){w.drawGraph(e),requestAnimationFrame(t)})),[2]}))},new((n=void 0)||(n=Promise))((function(i,o){function l(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,a)}u((r=r.apply(t,e||[])).next())}));var t,e,n,r},"complete"===document.readyState?m():document.addEventListener("readystatechange",(function(){"complete"===document.readyState&&m()}))})();