(()=>{"use strict";var t,e,n=function(){function t(t,e,n,r){this.x=t,this.y=e,this.width=n,this.height=r}return t.create=function(t){return new this(t.x,t.y,t.width,t.height)},t.prototype.splitTop=function(e){return[new t(this.x,this.y,this.width,e),new t(this.x,this.y+e,this.width,this.height-e)]},t.prototype.splitBottom=function(e){return[new t(this.x,this.y,this.width,this.height-e),new t(this.x,this.y+(this.height-e),this.width,e)]},t.prototype.splitLeft=function(e){return[new t(this.x,this.y,e,this.height),new t(this.x+e,this.y,this.width-e,this.height)]},t.prototype.splitRight=function(e){return[new t(this.x,this.y,this.width-e,this.height),new t(this.x+(this.width-e),this.y,e,this.height)]},t}(),r=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),l=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)l.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return l},i=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},o=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];throw new Error(String.raw.apply(String,i([t],r(e))))},l=function(e){return o(t||(n=["unreachable"],r=["unreachable"],Object.defineProperty?Object.defineProperty(n,"raw",{value:r}):n.raw=r,t=n));var n,r};!function(t){t.fromArrayOrError=function(t,e){if(e.length===t)return e;throw new Error("length: "+t+", array.length: "+e.length+", array: "+JSON.stringify(e))},t.last=function(t){return t[t.length-1]}}(e||(e={}));const a=e;var u,s,c,h,f,p,y,d,v,g,m,w,b,x=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},S=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),l=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)l.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return l},_=function(t){switch(t){case"波型":return"Wave";case"跳ね小型":return"JumpSmall";case"跳ね大型":return"JumpBig";case"減少型":return"Decrease";default:return"?"}},O=function(t,e,n){return e.reduce((function(t,e){var r=n(e);return t<r?r:t}),t)},T=function(t){return t.actualBoundingBoxAscent+t.actualBoundingBoxDescent},k=function(){function t(){}return t.Defaults={fillStyle:"#000",lineWidth:1,strokeStyle:"#000"},t}(),A=function(){function t(){this.visuals=[]}return t.prototype.push=function(t){this.visuals.push(t)},t.prototype.clear=function(){this.visuals.length=0},t.prototype.render=function(t){t.context.save();for(var e=0,n=this.visuals;e<n.length;e++)n[e].render(t);t.context.restore()},t}(),E=(p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),M=function(t){function e(e,n,r,i){var o,l,a,u,s=t.call(this)||this;return s.text=e,s.x=n,s.y=r,s.font=null!==(o=null==i?void 0:i.font)&&void 0!==o?o:"0.8rem 'YuGothic', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica', sans-serif",s.fillStyle=null!==(l=null==i?void 0:i.fillStyle)&&void 0!==l?l:k.Defaults.fillStyle,s.textAlign=null!==(a=null==i?void 0:i.textAlign)&&void 0!==a?a:"start",s.textBaseline=null!==(u=null==i?void 0:i.textBaseline)&&void 0!==u?u:"alphabetic",s}return E(e,t),e.prototype.render=function(t){var e=t.context;e.font=this.font,e.fillStyle=this.fillStyle,e.textAlign=this.textAlign,e.textBaseline=this.textBaseline,e.fillText(this.text,this.x,this.y)},e}(k),j=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),B=function(t){function e(e,n,r,i,o){var l,a,u=t.call(this)||this;return u.x1=e,u.y1=n,u.x2=r,u.y2=i,u.lineWidth=null!==(l=null==o?void 0:o.lineWidth)&&void 0!==l?l:k.Defaults.lineWidth,u.strokeStyle=null!==(a=null==o?void 0:o.strokeStyle)&&void 0!==a?a:k.Defaults.strokeStyle,u}return j(e,t),e.prototype.render=function(t){var e=t.context;e.lineWidth=this.lineWidth,e.strokeStyle=this.strokeStyle,e.beginPath(),e.moveTo(0|this.x1,0|this.y1),e.lineTo(0|this.x2,0|this.y2),e.stroke()},e}(k),P=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),W=function(){function t(){this._segments=[]}return t.prototype.moveTo=function(t,e){this._segments.push(0,t,e)},t.prototype.lineTo=function(t,e){this._segments.push(1,t,e)},t.prototype.itemKind=function(t){return this._segments[3*t]},t.prototype.itemX=function(t){return this._segments[3*t+1]},t.prototype.itemY=function(t){return this._segments[3*t+2]},Object.defineProperty(t.prototype,"count",{get:function(){return this._segments.length/3},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){return new Float64Array(this._segments)},t}(),C=function(t){function e(e,n){var r,i,o,l,a=t.call(this)||this;return a.path=e.serialize(),a.lineWidth=null!==(r=null==n?void 0:n.lineWidth)&&void 0!==r?r:k.Defaults.lineWidth,a.strokeStyle=null!==(i=null==n?void 0:n.strokeStyle)&&void 0!==i?i:k.Defaults.strokeStyle,a.fillStyle=null!==(o=null==n?void 0:n.fillStyle)&&void 0!==o?o:k.Defaults.fillStyle,a.drawingMode=null!==(l=null==n?void 0:n.drawingMode)&&void 0!==l?l:1,a}return P(e,t),e.prototype.render=function(t){var e=t.context,n=this.path,r=this.drawingMode;e.lineWidth=this.lineWidth,e.strokeStyle=this.strokeStyle,e.fillStyle=this.fillStyle,e.beginPath(),e.moveTo(0,0);for(var i=0,o=n.length;i<o;i+=3){var a=n[i],u=n[i+1],s=n[i+2];switch(a){case 0:e.moveTo(u,s);break;case 1:e.lineTo(u,s);break;default:l()}}switch(r){case 0:return e.fill();case 1:return e.stroke();default:l()}},e}(k),D=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},G=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),l=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)l.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return l},L=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},F=function(){function t(){var t;this.dataSource=[],this.visuals=new A,this.previousTimestampMs=performance.now();var e=function(){var t=document.createElement("div"),e=t.style;e.width="100%",e.height="32em",e.marginTop=e.marginBottom="2%";var n=document.createElement("canvas");return n.style.display="block",t.appendChild(n),{pictureFrame:t,canvas:n}}(),n=e.pictureFrame,r=e.canvas;this.pictureFrame=n,this.canvas=r,this.renderingContext=null!==(t=r.getContext("2d"))&&void 0!==t?t:o(y||(y=D(["2d context"],["2d context"])))}return Object.defineProperty(t.prototype,"element",{get:function(){return this.pictureFrame},enumerable:!1,configurable:!0}),t.prototype.createLabel=function(t){return{text:t,font:this.renderingContext.font="0.8rem 'YuGothic', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica', sans-serif",metrics:this.renderingContext.measureText(t)}},t.prototype.setDataSource=function(t){this.dataSource=t,this.updateGraphVisuals(),this.drawGraph(performance.now())},t.prototype.setCanvasSize=function(t,e){this.canvas.width=t,this.canvas.height=e,this.updateGraphVisuals(),this.drawGraph(performance.now())},t.prototype.updateGraphVisuals=function(){var t=this,e=this,r=e.canvas,i=e.visuals,o=e.dataSource,l=n.create({x:0,y:0,width:r.width,height:r.height});r.scrollIntoView();var u,s,c=Array.from("月火水木金土").flatMap((function(t){return[t+"前",t+"後"]})).map((function(e){return{label:t.createLabel(e)}})),h=(u=O(0,o,(function(t){return O(0,t.values,(function(t){var e=G(t,2),n=e[0],r=e[1];return Math.max(n,r)}))})),s=Math.pow(10,Math.floor(Math.log10(Math.abs(u)))),Math.ceil(u/s)*s),f=h/4,p=[0,f,2*f,3*f,h].map((function(e){var n=String(e);return{value:e,label:t.createLabel(n)}})),y=O(0,p,(function(t){return t.label.metrics.width})),d=O(0,c,(function(t){return T(t.label.metrics)})),v=G(l.splitRight(O(0,c,(function(t){return t.label.metrics.width/2}))),2),g=v[0],m=v[1],w=G(g.splitTop(O(0,p,(function(t){return T(t.label.metrics)}))),2),b=(w[0],w[1]),x=G(b.splitBottom(d+.05*l.height),2),S=x[0],_=x[1],k=m.width,A=G(S.splitLeft(y+k),2),E=A[0],j=A[1],P=G(_.splitLeft(E.width),2)[1],D=function(t){return E.y+(E.height-t*(E.height/(p.length-1)))};i.clear();var F={fillStyle:"gray",textAlign:"right",textBaseline:"middle"};p.forEach((function(t,e){var n=t.label,r=E.width-k,o=D(e);i.push(new M(n.text,r,o,F))}));var q={lineWidth:1};p.forEach((function(t,e){q.strokeStyle=0===e?"rgba(0, 0, 0, 0.5)":"rgba(0, 0, 0, 0.2)";var n=E.width-k,r=D(e);i.push(new B(n,r,l.width,r,q))}));var z={textAlign:"center",textBaseline:"bottom",fillStyle:"gray"};c.forEach((function(t,e){var n=t.label,r=P.x+e*(P.width/(c.length-1)),o=l.height;i.push(new M(n.text,r,o,z))}));var N=function(t,e,n){void 0===n&&(n=!1);var r=t.values,i=t.probability,o=function(t,e){return[j.x+e*(j.width/(r.length-1)),j.y+j.height-j.height*(t/h)]},l=G(r[0],2)[1],u=G(function(t,e,n){var r=t/60,i=1*(1-Math.abs(r%2-1)),o=0,l=0,a=0;0<=r&&r<1&&(o=1,l=i,a=0),1<=r&&r<2&&(o=i,l=1,a=0),2<=r&&r<3&&(o=0,l=1,a=i),3<=r&&r<4&&(o=0,l=i,a=1),4<=r&&r<5&&(o=i,l=0,a=1),5<=r&&r<6&&(o=1,l=0,a=i);return[o=255*(o+=0)|0,l=255*(l+=0)|0,a=255*(a+=0)|0]}(e),3),s=u[0],c=u[1],f=u[2],p=new W;p.moveTo.apply(p,L([],G(o(l,0)))),r.forEach((function(t,e){var n=G(t,2)[1];p.lineTo.apply(p,L([],G(o(n,e))))}));var y=G(a.last(r),1)[0],d=o(y,r.length-1);return n?p.lineTo.apply(p,L([],G(d))):p.moveTo.apply(p,L([],G(d))),r.concat().reverse().forEach((function(t,e,n){var r=G(t,1)[0];p.lineTo.apply(p,L([],G(o(r,n.length-e-1))))})),new C(p,{lineWidth:1,strokeStyle:"rgba("+s+", "+c+", "+f+", 0.2)",fillStyle:"rgba("+s+", "+c+", "+f+", "+.5*i+")",drawingMode:n?0:1})};o.forEach((function(t,e){var n=e/o.length*360;i.push(N(t,n)),i.push(N(t,n,!0))})),console.log(JSON.stringify({yLabelArea:E}))},t.prototype.drawGraph=function(t){var e=this.previousTimestampMs-t;this.previousTimestampMs=t;var n=this,r=n.canvas,i=n.renderingContext,o=n.visuals;i.clearRect(0,0,r.width,r.height);var l={context:i,timeSpan:e};o.render(l)},t.prototype.draw=function(t){this.drawGraph(t)},t}();w=new F,b=w.element,m=function(){return t=void 0,e=void 0,r=function(){var t,e,n,r,i;return function(t,e){var n,r,i,o,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,r=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!((i=(i=l.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){l=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){l.label=o[1];break}if(6===o[0]&&l.label<i[1]){l.label=i[1],i=o;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(o);break}i[2]&&l.ops.pop(),l.trys.pop();continue}o=e.call(t,l)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(l){return t=null!==(n=document.querySelector("#filter"))&&void 0!==n?n:o(d||(d=D(["#filter"],["#filter"]))),(null!==(r=t.parentElement)&&void 0!==r?r:o(v||(v=D(["parent"],["parent"])))).insertBefore(b,t.nextSibling),e=null!==(i=document.querySelector("#output"))&&void 0!==i?i:o(g||(g=D(["#output"],["#output"]))),new ResizeObserver((function(){console.log("グラフ再描画 ( 額縁のサイズ変更 )"),w.setCanvasSize(b.offsetWidth,b.offsetHeight)})).observe(b),new MutationObserver((function(){var t;console.log("グラフ再描画 ( 元データの変更 )"),w.setDataSource((t=e,Array.from(t.querySelectorAll(":scope > tr")).filter((function(t){return 0===t.classList.length})).map((function(t){var e,n,r=S(Array.from(t.querySelectorAll("td"))),i=r[0],l=void 0===i?o(u||(u=x(["variant"],["variant"]))):i,p=r[1],y=void 0===p?o(s||(s=x(["probability"],["probability"]))):p,d=r.slice(3),v=d.slice(0,d.length-2);return{variant:_(l.innerText.trim()),probability:.01*Number(null!==(n=null===(e=/^\s*(.+)%\s*$/.exec(y.innerText))||void 0===e?void 0:e[1])&&void 0!==n?n:o(c||(c=x(["probability"],["probability"])))),values:a.fromArrayOrError(12,v.map((function(t){var e,n=S(null!==(e=/^\s*(\d+)(~(\d+))?\s*$/.exec(t.innerText))&&void 0!==e?e:o(h||(h=x(["values"],["values"]))),4),r=n[1],i=void 0===r?o(f||(f=x(["values.min"],["values.min"]))):r,l=n[3],a=void 0===l?i:l;return[Number(i),Number(a)]})))}}))))})).observe(e,{childList:!0,subtree:!0}),requestAnimationFrame((function t(e){w.draw(e),requestAnimationFrame(t)})),[2]}))},new((n=void 0)||(n=Promise))((function(i,o){function l(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,a)}u((r=r.apply(t,e||[])).next())}));var t,e,n,r},"complete"===document.readyState?m():document.addEventListener("readystatechange",(function(){"complete"===document.readyState&&m()}))})();