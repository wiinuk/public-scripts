(()=>{"use strict";var t,e=function(){function t(t,e,r,n){this.x=t,this.y=e,this.width=r,this.height=n}return t.create=function(t){return new this(t.x,t.y,t.width,t.height)},t.prototype.splitTop=function(e){return[new t(this.x,this.y,this.width,e),new t(this.x,this.y+e,this.width,this.height-e)]},t.prototype.splitBottom=function(e){return[new t(this.x,this.y,this.width,this.height-e),new t(this.x,this.y+(this.height-e),this.width,e)]},t.prototype.splitLeft=function(e){return[new t(this.x,this.y,e,this.height),new t(this.x+e,this.y,this.width-e,this.height)]},t.prototype.splitRight=function(e){return[new t(this.x,this.y,this.width-e,this.height),new t(this.x+(this.width-e),this.y,e,this.height)]},t}(),r=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},n=function(t,e){for(var r=0,n=e.length,i=t.length;r<n;r++,i++)t[i]=e[r];return t},i=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];throw new Error(String.raw.apply(String,n([t],r(e))))};!function(t){t.fromArrayOrError=function(t,e){if(e.length===t)return e;throw new Error("length: "+t+", array.length: "+e.length+", array: "+JSON.stringify(e))},t.last=function(t){return t[t.length-1]}}(t||(t={}));const o=t;var a,l,u,c,h,f,s,p,y,d,v,g,b=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},m=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},w=function(t){switch(t){case"波型":return"Wave";case"跳ね小型":return"JumpSmall";case"跳ね大型":return"JumpBig";case"減少型":return"Decrease";default:return"?"}},x=function(t){return Array.from(t.querySelectorAll(":scope > tr")).filter((function(t){return 0===t.classList.length})).map((function(t){var e,r,n=m(Array.from(t.querySelectorAll("td"))),f=n[0],s=void 0===f?i(a||(a=b(["variant"],["variant"]))):f,p=n[1],y=void 0===p?i(l||(l=b(["probability"],["probability"]))):p,d=n.slice(3),v=d.slice(0,d.length-2);return{variant:w(s.innerText.trim()),probability:.01*Number(null!==(r=null===(e=/^\s*(.+)%\s*$/.exec(y.innerText))||void 0===e?void 0:e[1])&&void 0!==r?r:i(u||(u=b(["probability"],["probability"])))),values:o.fromArrayOrError(12,v.map((function(t){var e,r=m(null!==(e=/^\s*(\d+)(~(\d+))?\s*$/.exec(t.innerText))&&void 0!==e?e:i(c||(c=b(["values"],["values"]))),4),n=r[1],o=void 0===n?i(h||(h=b(["values.min"],["values.min"]))):n,a=r[3],l=void 0===a?o:a;return[Number(o),Number(l)]})))}}))},S=function(t,e,r){return e.reduce((function(t,e){var n=r(e);return t<n?n:t}),t)},T=function(t){return t.actualBoundingBoxAscent+t.actualBoundingBoxDescent},E=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},B=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},A=function(t,e){for(var r=0,n=e.length,i=t.length;r<n;r++,i++)t[i]=e[r];return t},O=function(){function t(){var t,e=function(){var t=document.createElement("div"),e=t.style;e.width="100%",e.height="32em",e.marginTop=e.marginBottom="2%";var r=document.createElement("canvas");return r.style.display="block",t.appendChild(r),{pictureFrame:t,canvas:r}}(),r=e.pictureFrame,n=e.canvas;this.pictureFrame=r,this.canvas=n,this.renderingContext=null!==(t=n.getContext("2d"))&&void 0!==t?t:i(f||(f=E(["2d context"],["2d context"])))}return Object.defineProperty(t.prototype,"element",{get:function(){return this.pictureFrame},enumerable:!1,configurable:!0}),t.prototype.createLabel=function(t){return{text:t,font:this.renderingContext.font="0.8rem 'YuGothic', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica', sans-serif",metrics:this.renderingContext.measureText(t)}},t.prototype.drawGraph=function(t){var r=this,n=this,i=n.canvas,a=n.pictureFrame,l=n.renderingContext,u=e.create({x:0,y:0,width:i.width=a.offsetWidth,height:i.height=a.offsetHeight});l.clearRect(0,0,u.width,u.height),i.scrollIntoView();var c,h,f=Array.from("月火水木金土").flatMap((function(t){return[t+"前",t+"後"]})).map((function(t){return{label:r.createLabel(t)}})),s=(c=S(0,t,(function(t){return S(0,t.values,(function(t){var e=B(t,2),r=e[0],n=e[1];return Math.max(r,n)}))})),h=Math.pow(10,Math.floor(Math.log10(Math.abs(c)))),Math.ceil(c/h)*h),p=s/4,y=[0,p,2*p,3*p,s].map((function(t){var e=String(t);return{value:t,label:r.createLabel(e)}})),d=S(0,y,(function(t){return t.label.metrics.width})),v=S(0,f,(function(t){return T(t.label.metrics)})),g=B(u.splitRight(S(0,f,(function(t){return t.label.metrics.width/2}))),2),b=g[0],m=g[1],w=B(b.splitTop(S(0,y,(function(t){return T(t.label.metrics)}))),2),x=(w[0],w[1]),E=B(x.splitBottom(v+.05*u.height),2),O=E[0],k=E[1],L=m.width,M=B(O.splitLeft(d+L),2),P=M[0],C=M[1],F=B(k.splitLeft(P.width),2)[1],j=function(t){return P.y+(P.height-t*(P.height/(y.length-1)))};l.fillStyle="gray",l.textAlign="right",l.textBaseline="middle",y.forEach((function(t,e){var r=t.label,n=P.width-L,i=j(e);l.font=r.font,l.fillText(r.text,n,i)})),l.lineWidth=1,y.forEach((function(t,e){l.strokeStyle=0===e?"rgba(0, 0, 0, 0.5)":"rgba(0, 0, 0, 0.2)";var r=P.width-L,n=j(e);l.beginPath(),l.moveTo(0|r,0|n),l.lineTo(0|u.width,0|n),l.stroke()})),l.textAlign="center",l.textBaseline="bottom",f.forEach((function(t,e){var r=t.label,n=F.x+e*(F.width/(f.length-1)),i=u.height;l.font=r.font,l.fillText(r.text,n,i)}));var G=function(t,e,r){void 0===r&&(r=!1);var n=t.values,i=t.probability,a=function(t,e){return[C.x+e*(C.width/(n.length-1)),C.y+C.height-C.height*(t/s)]},u=B(n[0],2)[1],c=B(function(t,e,r){var n=t/60,i=1*(1-Math.abs(n%2-1)),o=0,a=0,l=0;0<=n&&n<1&&(o=1,a=i,l=0),1<=n&&n<2&&(o=i,a=1,l=0),2<=n&&n<3&&(o=0,a=1,l=i),3<=n&&n<4&&(o=0,a=i,l=1),4<=n&&n<5&&(o=i,a=0,l=1),5<=n&&n<6&&(o=1,a=0,l=i);return[o=255*(o+=0)|0,a=255*(a+=0)|0,l=255*(l+=0)|0]}(e),3),h=c[0],f=c[1],p=c[2];l.lineWidth=1,l.strokeStyle="rgba("+h+", "+f+", "+p+", 0.2)",l.fillStyle="rgba("+h+", "+f+", "+p+", "+.5*i+")",l.beginPath(),l.moveTo.apply(l,A([],B(a(u,0)))),n.forEach((function(t,e){var r=B(t,2)[1];l.lineTo.apply(l,A([],B(a(r,e))))}));var y=B(o.last(n),1)[0],d=a(y,n.length-1);r?l.lineTo.apply(l,A([],B(d))):l.moveTo.apply(l,A([],B(d))),n.concat().reverse().forEach((function(t,e,r){var n=B(t,1)[0];l.lineTo.apply(l,A([],B(a(n,r.length-e-1))))})),r?l.fill():l.stroke()};t.forEach((function(e,r){var n=r/t.length*360;G(e,n),G(e,n,!0)})),console.log(JSON.stringify({yLabelArea:P}))},t}();v=new O,g=v.element,d=function(){return t=void 0,e=void 0,n=function(){var t,e,r,n,o;return function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(a){return t=null!==(r=document.querySelector("#filter"))&&void 0!==r?r:i(s||(s=E(["#filter"],["#filter"]))),(null!==(n=t.parentElement)&&void 0!==n?n:i(p||(p=E(["parent"],["parent"])))).insertBefore(g,t.nextSibling),e=null!==(o=document.querySelector("#output"))&&void 0!==o?o:i(y||(y=E(["#output"],["#output"]))),new ResizeObserver((function(){console.log("グラフ再描画 ( 額縁のサイズ変更 )"),v.drawGraph(x(e))})).observe(g),new MutationObserver((function(){console.log("グラフ再描画 ( 元データの変更 )"),v.drawGraph(x(e))})).observe(e,{childList:!0,subtree:!0}),[2]}))},new((r=void 0)||(r=Promise))((function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function l(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,l)}u((n=n.apply(t,e||[])).next())}));var t,e,r,n},"complete"===document.readyState?d():document.addEventListener("readystatechange",(function(){"complete"===document.readyState&&d()}))})();