(()=>{"use strict";var t,e=function(){function t(t,e,r,n){this.x=t,this.y=e,this.width=r,this.height=n}return t.create=function(t){return new this(t.x,t.y,t.width,t.height)},t.prototype.splitTop=function(e){return[new t(this.x,this.y,this.width,e),new t(this.x,this.y+e,this.width,this.height-e)]},t.prototype.splitBottom=function(e){return[new t(this.x,this.y,this.width,this.height-e),new t(this.x,this.y+(this.height-e),this.width,e)]},t.prototype.splitLeft=function(e){return[new t(this.x,this.y,e,this.height),new t(this.x+e,this.y,this.width-e,this.height)]},t.prototype.splitRight=function(e){return[new t(this.x,this.y,this.width-e,this.height),new t(this.x+(this.width-e),this.y,e,this.height)]},t}(),r=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},n=function(t,e){for(var r=0,n=e.length,i=t.length;r<n;r++,i++)t[i]=e[r];return t},i=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];throw new Error(String.raw.apply(String,n([t],r(e))))};!function(t){t.fromArrayOrError=function(t,e){if(e.length===t)return e;throw new Error("length: "+t+", array.length: "+e.length+", array: "+JSON.stringify(e))},t.last=function(t){return t[t.length-1]}}(t||(t={}));const o=t;var a,l,u,c,h,f,s,y,d,v,p,g,b,m,w,x,S,T=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},E=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},B=function(t){switch(t){case"波型":return"Wave";case"跳ね小型":return"JumpSmall";case"跳ね大型":return"JumpBig";case"減少型":return"Decrease";default:return"?"}},A=function(t,e,r){return e.reduce((function(t,e){var n=r(e);return t<n?n:t}),t)},k=function(t){return t.actualBoundingBoxAscent+t.actualBoundingBoxDescent},M=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},O=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},L=function(t,e){for(var r=0,n=e.length,i=t.length;r<n;r++,i++)t[i]=e[r];return t};g=function(){var t=document.createElement("div"),e=t.style;e.width="100%",e.height="32em",e.marginTop=e.marginBottom="2%";var r=document.createElement("canvas");return r.style.display="block",t.appendChild(r),{pictureFrame:t,canvas:r}}(),b=g.pictureFrame,m=g.canvas,w=null!==(v=m.getContext("2d"))&&void 0!==v?v:i(f||(f=M(["2d context"],["2d context"]))),x=function(t){return{text:t,font:w.font="0.8rem 'YuGothic', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica', sans-serif",metrics:w.measureText(t)}},S=function(t){var r=e.create({x:0,y:0,width:m.width=b.offsetWidth,height:m.height=b.offsetHeight});w.clearRect(0,0,r.width,r.height),m.scrollIntoView();var n,f,s,y=(n=t,Array.from(n.querySelectorAll(":scope > tr")).filter((function(t){return 0===t.classList.length})).map((function(t){var e,r,n=E(Array.from(t.querySelectorAll("td"))),f=n[0],s=void 0===f?i(a||(a=T(["variant"],["variant"]))):f,y=n[1],d=void 0===y?i(l||(l=T(["probability"],["probability"]))):y,v=n.slice(3),p=v.slice(0,v.length-2);return{variant:B(s.innerText.trim()),probability:.01*Number(null!==(r=null===(e=/^\s*(.+)%\s*$/.exec(d.innerText))||void 0===e?void 0:e[1])&&void 0!==r?r:i(u||(u=T(["probability"],["probability"])))),values:o.fromArrayOrError(12,p.map((function(t){var e,r=E(null!==(e=/^\s*(\d+)(~(\d+))?\s*$/.exec(t.innerText))&&void 0!==e?e:i(c||(c=T(["values"],["values"]))),4),n=r[1],o=void 0===n?i(h||(h=T(["values.min"],["values.min"]))):n,a=r[3],l=void 0===a?o:a;return[Number(o),Number(l)]})))}}))),d=Array.from("月火水木金土").flatMap((function(t){return[t+"前",t+"後"]})).map((function(t){return{label:x(t)}})),v=(f=A(0,y,(function(t){return A(0,t.values,(function(t){var e=O(t,2),r=e[0],n=e[1];return Math.max(r,n)}))})),s=Math.pow(10,Math.floor(Math.log10(Math.abs(f)))),Math.ceil(f/s)*s),p=v/4,g=[0,p,2*p,3*p,v].map((function(t){var e=String(t);return{value:t,label:x(e)}})),S=A(0,g,(function(t){return t.label.metrics.width})),M=A(0,d,(function(t){return k(t.label.metrics)})),P=O(r.splitRight(A(0,d,(function(t){return t.label.metrics.width/2}))),2),N=P[0],j=P[1],q=O(N.splitTop(A(0,g,(function(t){return k(t.label.metrics)}))),2),J=(q[0],q[1]),R=O(J.splitBottom(M+.05*r.height),2),W=R[0],F=R[1],C=j.width,D=O(W.splitLeft(S+C),2),G=D[0],H=D[1],I=O(F.splitLeft(G.width),2)[1],$=function(t){return G.y+(G.height-t*(G.height/(g.length-1)))};w.fillStyle="gray",w.textAlign="right",w.textBaseline="middle",g.forEach((function(t,e){var r=t.label,n=G.width-C,i=$(e);w.font=r.font,w.fillText(r.text,n,i)})),w.lineWidth=1,g.forEach((function(t,e){w.strokeStyle=0===e?"rgba(0, 0, 0, 0.5)":"rgba(0, 0, 0, 0.2)";var n=G.width-C,i=$(e);w.beginPath(),w.moveTo(0|n,0|i),w.lineTo(0|r.width,0|i),w.stroke()})),w.textAlign="center",w.textBaseline="bottom",d.forEach((function(t,e){var n=t.label,i=I.x+e*(I.width/(d.length-1)),o=r.height;w.font=n.font,w.fillText(n.text,i,o)}));var z=function(t,e,r){void 0===r&&(r=!1);var n=t.values,i=t.probability,a=function(t,e){return[H.x+e*(H.width/(n.length-1)),H.y+H.height-H.height*(t/v)]},l=O(n[0],2)[1],u=O(function(t,e,r){var n=t/60,i=1*(1-Math.abs(n%2-1)),o=0,a=0,l=0;0<=n&&n<1&&(o=1,a=i,l=0),1<=n&&n<2&&(o=i,a=1,l=0),2<=n&&n<3&&(o=0,a=1,l=i),3<=n&&n<4&&(o=0,a=i,l=1),4<=n&&n<5&&(o=i,a=0,l=1),5<=n&&n<6&&(o=1,a=0,l=i);return[o=255*(o+=0)|0,a=255*(a+=0)|0,l=255*(l+=0)|0]}(e),3),c=u[0],h=u[1],f=u[2];w.lineWidth=1,w.strokeStyle="rgba("+c+", "+h+", "+f+", 0.2)",w.fillStyle="rgba("+c+", "+h+", "+f+", "+.5*i+")",w.beginPath(),w.moveTo.apply(w,L([],O(a(l,0)))),n.forEach((function(t,e){var r=O(t,2)[1];w.lineTo.apply(w,L([],O(a(r,e))))}));var s=O(o.last(n),1)[0],y=a(s,n.length-1);r?w.lineTo.apply(w,L([],O(y))):w.moveTo.apply(w,L([],O(y))),n.concat().reverse().forEach((function(t,e,r){var n=O(t,1)[0];w.lineTo.apply(w,L([],O(a(n,r.length-e-1))))})),r?w.fill():w.stroke()};y.forEach((function(t,e){var r=e/y.length*360;z(t,r),z(t,r,!0)})),console.log(JSON.stringify({yLabelArea:G}))},p=function(){return t=void 0,e=void 0,n=function(){var t,e,r,n,o;return function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(a){return t=null!==(r=document.querySelector("#filter"))&&void 0!==r?r:i(s||(s=M(["#filter"],["#filter"]))),(null!==(n=t.parentElement)&&void 0!==n?n:i(y||(y=M(["parent"],["parent"])))).insertBefore(b,t.nextSibling),e=null!==(o=document.querySelector("#output"))&&void 0!==o?o:i(d||(d=M(["#output"],["#output"]))),new ResizeObserver((function(){console.log("グラフ再描画 ( 額縁のサイズ変更 )"),S(e)})).observe(b),new MutationObserver((function(){console.log("グラフ再描画 ( 元データの変更 )"),S(e)})).observe(e,{childList:!0,subtree:!0}),[2]}))},new((r=void 0)||(r=Promise))((function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function l(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,l)}u((n=n.apply(t,e||[])).next())}));var t,e,r,n},"complete"===document.readyState?p():document.addEventListener("readystatechange",(function(){"complete"===document.readyState&&p()}))})();